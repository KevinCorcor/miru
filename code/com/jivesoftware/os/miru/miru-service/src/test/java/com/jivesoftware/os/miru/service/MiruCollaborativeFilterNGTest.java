/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.jivesoftware.os.miru.service;

import com.google.common.base.Optional;
import com.google.common.collect.ArrayListMultimap;
import com.google.common.collect.ImmutableList;
import com.google.common.collect.Lists;
import com.google.common.collect.Maps;
import com.google.common.primitives.Bytes;
import com.googlecode.javaewah.EWAHCompressedBitmap;
import com.jivesoftware.os.jive.utils.http.client.HttpClientConfiguration;
import com.jivesoftware.os.jive.utils.http.client.HttpClientFactory;
import com.jivesoftware.os.jive.utils.http.client.HttpClientFactoryProvider;
import com.jivesoftware.os.jive.utils.io.FilerIO;
import com.jivesoftware.os.jive.utils.row.column.value.store.api.SetOfSortedMapsImplInitializer;
import com.jivesoftware.os.jive.utils.row.column.value.store.inmemory.InMemorySetOfSortedMapsImplInitializer;
import com.jivesoftware.os.miru.api.*;
import com.jivesoftware.os.miru.api.activity.MiruActivity;
import com.jivesoftware.os.miru.api.activity.MiruPartitionId;
import com.jivesoftware.os.miru.api.activity.MiruPartitionedActivity;
import com.jivesoftware.os.miru.api.activity.MiruPartitionedActivityFactory;
import com.jivesoftware.os.miru.api.base.MiruTenantId;
import com.jivesoftware.os.miru.api.base.MiruTermId;
import com.jivesoftware.os.miru.api.query.RecoQuery;
import com.jivesoftware.os.miru.api.query.filter.MiruAuthzExpression;
import com.jivesoftware.os.miru.api.query.filter.MiruFieldFilter;
import com.jivesoftware.os.miru.api.query.filter.MiruFilter;
import com.jivesoftware.os.miru.api.query.filter.MiruFilterOperation;
import com.jivesoftware.os.miru.api.query.result.RecoResult;
import com.jivesoftware.os.miru.cluster.MiruClusterRegistry;
import com.jivesoftware.os.miru.cluster.MiruRegistryStore;
import com.jivesoftware.os.miru.cluster.MiruRegistryStoreInitializer;
import com.jivesoftware.os.miru.cluster.MiruReplicaSet;
import com.jivesoftware.os.miru.cluster.rcvs.MiruRCVSClusterRegistry;
import com.jivesoftware.os.miru.service.index.MiruFieldDefinition;
import com.jivesoftware.os.miru.service.schema.MiruSchema;
import com.jivesoftware.os.miru.service.stream.filter.MatchNoMoreThanNBitmapStorage;
import com.jivesoftware.os.miru.service.stream.locator.MiruResourceLocatorProvider;
import com.jivesoftware.os.miru.wal.MiruWALInitializer;
import org.merlin.config.BindInterfaceToConfiguration;
import org.testng.Assert;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import java.util.*;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.atomic.AtomicInteger;

import static org.testng.Assert.assertEquals;
import static org.testng.Assert.assertTrue;

/**
 * @author jonathan
 */
public class MiruCollaborativeFilterNGTest {

    MiruTenantId tenant1 = new MiruTenantId("tenant1".getBytes());

    MiruPartitionedActivityFactory partitionedActivityFactory = new MiruPartitionedActivityFactory();
    MiruService service;
    MiruPartitionId partitionId = MiruPartitionId.of(1);

    @BeforeMethod
    public void setUpMethod() throws Exception {

        MiruSchema miruSchema = new MiruSchema(
                new MiruFieldDefinition(0, "user", false, ImmutableList.of("doc"), ImmutableList.<String>of()),
                new MiruFieldDefinition(1, "doc", false, ImmutableList.of("user"), ImmutableList.of("user")));

        MiruBackingStorage disiredStorage = MiruBackingStorage.memory;

        MiruServiceConfig config = BindInterfaceToConfiguration.bindDefault(MiruServiceConfig.class);
        config.setDefaultStorage(disiredStorage.name());

        MiruHost miruHost = new MiruHost("logicalName", 1234);
        HttpClientFactory httpClientFactory = new HttpClientFactoryProvider()
                .createHttpClientFactory(Collections.<HttpClientConfiguration>emptyList());

        SetOfSortedMapsImplInitializer setOfSortedMapsImplInitializer = new InMemorySetOfSortedMapsImplInitializer();
        MiruRegistryStore registryStore = new MiruRegistryStoreInitializer().initialize("test", setOfSortedMapsImplInitializer);
        MiruClusterRegistry clusterRegistry = new MiruRCVSClusterRegistry(registryStore.getHostsRegistry(),
                registryStore.getExpectedTenantsRegistry(),
                registryStore.getExpectedTenantPartitionsRegistry(),
                registryStore.getReplicaRegistry(),
                registryStore.getTopologyRegistry(),
                registryStore.getConfigRegistry(),
                3,
                TimeUnit.HOURS.toMillis(1));

        clusterRegistry.sendHeartbeatForHost(miruHost, 0, 0);
        clusterRegistry.electToReplicaSetForTenantPartition(tenant1, partitionId,
                new MiruReplicaSet(ArrayListMultimap.<MiruPartitionState, MiruPartition>create(), new HashSet<MiruHost>(), 3));
        clusterRegistry.refreshTopology(new MiruPartitionCoord(tenant1, partitionId, miruHost), new MiruPartitionCoordMetrics(0, 0),
                System.currentTimeMillis());

        MiruWALInitializer.MiruWAL wal = new MiruWALInitializer().initialize("test", setOfSortedMapsImplInitializer);

        MiruLifecyle<MiruResourceLocatorProvider> miruResourceLocatorProviderLifecyle = new MiruTempResourceLocatorProviderInitializer().initialize();
        miruResourceLocatorProviderLifecyle.start();
        MiruLifecyle<MiruService> miruServiceLifecyle = new MiruServiceInitializer().initialize(config,
                registryStore,
                clusterRegistry,
                miruHost,
                miruSchema,
                wal,
                httpClientFactory,
                miruResourceLocatorProviderLifecyle.getService());

        miruServiceLifecyle.start();
        MiruService miruService = miruServiceLifecyle.getService();

        long t = System.currentTimeMillis();
        while (!miruService.checkInfo(tenant1, partitionId, new MiruPartitionCoordInfo(MiruPartitionState.online, disiredStorage))) {
            Thread.sleep(10);
            if (System.currentTimeMillis() - t > TimeUnit.SECONDS.toMillis(5000)) {
                Assert.fail("Partition failed to come online");
            }
        }

        this.service = miruService;
    }

    static long optimalNumOfBits(long n, double p) {
        if (p == 0) {
            p = Double.MIN_VALUE;
        }
        return (long) (-n * Math.log(p) / (Math.log(2) * Math.log(2)));
    }

    @Test(enabled = true)
    public void basicTest() throws Exception {

        // P , G, C
        // P G P
        // P C P
        // G P G
        // C P C
        // I am looking at this persons what content should I look at?
        // I am looking at this group what content should I look at?

        AtomicInteger time = new AtomicInteger();
        List<MiruPartitionedActivity> activities = new ArrayList<>();
        Random rand = new Random(1234);
        int numberOfUsers = 10_000;
        int numberOfDocument = 10_000;
        int numberOfViewsPerUser = 100;
        System.out.println("Building activities....");
        long start = System.currentTimeMillis();
        for (int i = 0; i < numberOfUsers; i++) {
            String user = "bob" + i;
            for (int d = 0; d < numberOfViewsPerUser; d++) {
                activities.add(viewActivity(time.incrementAndGet(), user, String.valueOf(rand.nextInt(numberOfDocument))));
            }
        }
        System.out.println("Built " + activities.size() + " in " + (System.currentTimeMillis() - start) + "millis");

        activities.add(viewActivity(time.incrementAndGet(), "bob0", "1"));
        activities.add(viewActivity(time.incrementAndGet(), "bob0", "2"));
        activities.add(viewActivity(time.incrementAndGet(), "bob0", "3"));
        activities.add(viewActivity(time.incrementAndGet(), "bob0", "4"));
        activities.add(viewActivity(time.incrementAndGet(), "bob0", "9"));

        activities.add(viewActivity(time.incrementAndGet(), "frank", "1"));
        activities.add(viewActivity(time.incrementAndGet(), "frank", "2"));
        activities.add(viewActivity(time.incrementAndGet(), "frank", "3"));
        activities.add(viewActivity(time.incrementAndGet(), "frank", "4"));
        activities.add(viewActivity(time.incrementAndGet(), "frank", "10"));

        activities.add(viewActivity(time.incrementAndGet(), "jane", "2"));
        activities.add(viewActivity(time.incrementAndGet(), "jane", "3"));
        activities.add(viewActivity(time.incrementAndGet(), "jane", "4"));
        activities.add(viewActivity(time.incrementAndGet(), "jane", "11"));

        activities.add(viewActivity(time.incrementAndGet(), "liz", "3"));
        activities.add(viewActivity(time.incrementAndGet(), "liz", "4"));
        activities.add(viewActivity(time.incrementAndGet(), "liz", "12"));
        activities.add(viewActivity(time.incrementAndGet(), "liz", "12"));

        System.out.println("Indexing...");
        start = System.currentTimeMillis();

//        int numPartitions = 8;
//        ExecutorService indexThread = Executors.newFixedThreadPool(numPartitions);
//        final CountDownLatch latch = new CountDownLatch(numPartitions);
        int activitiesPerPartition = 10_000;
        int count = 0;
        for (final List<MiruPartitionedActivity> partition : Lists.partition(activities, activitiesPerPartition)) { // activities.size() / numPartitions)) {
//
//            indexThread.submit(new Runnable() {
//
//                @Override
//                public void run() {
//                    try {
            service.writeToIndex(partition);
            count += activitiesPerPartition;
            System.out.println("Finished " + count + " in " + (System.currentTimeMillis() - start) + " ms");
//                    } catch (Exception x) {
//                        x.printStackTrace();
//                    } finally {
//                        latch.countDown();
//                    }
//                }
//            });
        }
//        latch.await();

        System.out.println("Indexed " + activities.size() + " in " + (System.currentTimeMillis() - start) + " ms");

        for (int i = 0; i < numberOfUsers; i++) {
            String user = "bob" + i;
            MiruFieldFilter miruFieldFilter = new MiruFieldFilter("user", ImmutableList.of(makeComposite(new MiruTermId(user.getBytes()), "^", "doc")));
            MiruFilter filter = new MiruFilter(
                    MiruFilterOperation.or,
                    Optional.of(ImmutableList.of(miruFieldFilter)),
                    Optional.<ImmutableList<MiruFilter>>absent());

            start = System.currentTimeMillis();
            RecoResult recoResult = service.collaborativeFilteringRecommendations(new RecoQuery(tenant1,
                    Optional.<MiruAuthzExpression>absent(),
                    filter,
                    "doc", "doc", "doc",
                    "user", "user", "user",
                    "doc", "doc",
                    10));

            System.out.println("recoResult:" + recoResult);
            System.out.println("Took:" + (System.currentTimeMillis() - start));
        }

    }

    private MiruTermId makeComposite(MiruTermId fieldValue, String separator, String fieldName) {
        return new MiruTermId(Bytes.concat(fieldValue.getBytes(), separator.getBytes(), fieldName.getBytes()));
    }

    private MiruPartitionedActivity viewActivity(int time, String user, String doc) {
        Map<String, MiruTermId[]> fieldsValues = Maps.newHashMap();
        fieldsValues.put("user", new MiruTermId[]{new MiruTermId(user.getBytes())});
        fieldsValues.put("doc", new MiruTermId[]{new MiruTermId(doc.getBytes())});

        MiruActivity activity = new MiruActivity.Builder(tenant1, time, new String[0], 0).putFieldsValues(fieldsValues).build();
        return partitionedActivityFactory.activity(1, partitionId, 1, activity);
    }

    private MiruPartitionedActivity buildActivity(int time, int verb, Integer container, int target, Integer tag, int author) {
        Map<String, MiruTermId[]> fieldsValues = Maps.newHashMap();
        fieldsValues.put("verb", new MiruTermId[]{new MiruTermId(FilerIO.intBytes(verb))});
        if (container != null) {
            fieldsValues.put("container", new MiruTermId[]{new MiruTermId(FilerIO.intBytes(container))});
        }
        fieldsValues.put("target", new MiruTermId[]{new MiruTermId(FilerIO.intBytes(target))});
        if (tag != null) {
            fieldsValues.put("tag", new MiruTermId[]{new MiruTermId(FilerIO.intBytes(tag))});
        }
        fieldsValues.put("author", new MiruTermId[]{new MiruTermId(FilerIO.intBytes(author))});
        String[] authz = new String[]{"aaabbbcccddd"};
        MiruActivity activity = new MiruActivity.Builder(tenant1, time, authz, 0).putFieldsValues(fieldsValues).build();
        return partitionedActivityFactory.activity(1, partitionId, 1, activity);
    }

    @Test
    public void testBrokenEWAH() {
        //bad size 620841
        //good size 620928
        long[] badData = new long[]{
                8589934620L, 2097152L, 8589934620L, 2097152L, 8589934624L, 1024L, 8589934612L, 549755813888L, 8589934630L, 268435456L, 8589934622L,
                8589934592L, 8589934622L, 2L, 8589934618L, 1L, 8589934622L, 33554432L, 8589934620L, 65536L, 8589934620L, 35184372088832L, 8589934620L,
                2305843009213693952L, 8589934628L, 16L, 8589934644L, 36028797018963968L, 8589934628L, 131072L, 8589934622L, 1024L, 8589934620L,
                1099511627776L, 8589934620L, 4611686018427387904L, 8589934620L, 137438953472L, 8589934618L, 281474976710656L, 8589934628L, 8589934592L,
                8589934620L, 70368744177664L, 8589934610L, 281474976710656L, 8589934634L, 256L, 8589934622L, 4096L, 8589934618L, 4294967296L, 8589934620L,
                17592186044416L, 8589934622L, 33554432L, 8589934618L, 68719476736L, 8589934622L, 4611686018427387904L, 8589934626L, 1048576L, 8589934618L,
                576460752303423488L, 8589934614L, 288230376151711744L, 8589934632L, 70368744177664L, 8589934618L, 131072L, 8589934624L, 70368744177664L,
                8589934614L, 4503599627370496L, 8589934628L, 36028797018963968L, 8589934622L, -9223372036854775808L, 8589934618L, 72057594037927936L,
                8589934622L, 562949953421312L, 8589934620L, 17179869184L, 8589934624L, 128L, 8589934620L, 2199023255552L, 8589934624L, 8796093022208L,
                8589934620L, 281474976710656L, 8589934622L, 1L, 8589934616L, 549755813888L, 8589934626L, 2L, 8589934620L, 2199023255552L, 8589934624L,
                1073741824L, 8589934620L, 4611686018427387904L, 8589934618L, 2097152L, 8589934624L, 262144L, 8589934616L, 65536L, 8589934626L, 131072L,
                8589934622L, 576460752303423488L, 8589934622L, 4L, 8589934622L, 256L, 8589934614L, 32768L, 8589934626L, 67108864L, 8589934622L, 1024L,
                8589934620L, 2199023255552L, 8589934618L, 9007199254740992L, 8589934620L, 4096L, 8589934626L, 524288L, 8589934614L, 2097152L, 8589934626L,
                33554432L, 8589934626L, 262144L, 8589934620L, 288230376151711744L, 8589934622L, 70368744177664L, 8589934622L, 8192L, 8589934620L,
                17592186044416L, 8589934622L, 65536L, 8589934618L, 8388608L, 8589934624L, 1048576L, 8589934620L, 4294967296L, 8589934622L, 134217728L,
                8589934616L, 140737488355328L, 8589934628L, 549755813888L, 8589934616L, 70368744177664L, 8589934626L, 274877906944L, 8589934622L, 33554432L,
                8589934620L, 1048576L, 8589934616L, 64L, 8589934616L, 4503599627370496L, 8589934632L, 131072L, 8589934616L, 16L, 8589934618L,
                -9223372036854775808L, 8589934630L, 70368744177664L, 8589934620L, 4096L, 8589934618L, 128L, 8589934622L, 576460752303423488L, 8589934620L,
                9007199254740992L, 8589934626L, 4611686018427387904L, 8589934622L, 64L, 8589934620L, 4503599627370496L, 8589934622L, 8192L, 8589934622L,
                16384L, 8589934614L, 1125899906842624L, 8589934628L, 17592186044416L, 8589934618L, 524288L, 8589934624L, 137438953472L, 8589934610L,
                1099511627776L, 8589934628L, 17592186044416L, 8589934622L, 1099511627776L, 8589934616L, 2048L, 8589934628L, 35184372088832L, 8589934624L, 4L,
                8589934622L, 8388608L, 8589934620L, 70368744177664L, 8589934610L, 4294967296L, 8589934628L, 32L, 8589934622L, 2097152L, 8589934622L, 1L,
                8589934618L, 144115188075855872L, 8589934626L, 2048L, 8589934616L, 140737488355328L, 8589934628L, 9007199254740992L, 8589934620L,
                2305843009213693952L, 8589934622L, 16L, 8589934614L, 1073741824L, 8589934622L, 64L, 8589934626L, 134217728L, 8589934622L, 4294967296L,
                8589934604L, 16384L, 8589934640L, 4L, 8589934620L, 562949953421312L, 8589934620L, 8192L, 8589934624L, 281474976710656L, 8589934618L,
                70368744177664L, 8589934622L, 562949953421312L, 8589934624L, 16L, 8589934620L, 17592186044416L, 8589934622L, 576460752303423488L,
                8589934616L, 9007199254740992L, 8589934618L, 70368744177664L, 8589934628L, 140737488355328L, 8589934616L, 274877906944L, 8589934624L, 1024L,
                8589934618L, 2305843009213693952L, 8589934628L, 4398046511104L, 8589934622L, 4611686018427387904L, 8589934618L, 16384L, 8589934624L,
                9007199254740992L, 8589934622L, 274877906944L, 8589934620L, 137438953472L, 8589934620L, 18014398509481984L, 8589934624L, 262144L,
                8589934618L, 4294967296L, 8589934624L, 1073741824L, 8589934622L, 2L, 8589934616L, 262144L, 8589934626L, 34359738368L, 8589934620L,
                144115188075855872L, 8589934616L, 16384L, 8589934624L, 4194304L, 8589934626L, 512L, 8589934620L, 288230376151711744L, 8589934622L,
                268435456L, 8589934620L, 32L, 8589934622L, 4L, 8589934622L, 128L, 8589934620L, 8192L, 8589934618L, 8388608L, 8589934624L, 67108864L,
                8589934606L, 35184372088832L, 8589934636L, 72057594037927936L, 8589934622L, 4611686018427387904L, 8589934622L, 16384L, 8589934614L,
                274877906944L, 8589934628L, 262144L, 8589934622L, 35184372088832L, 8589934620L, 4L, 8589934622L, 32768L, 8589934622L, 68719476736L,
                8589934620L, 2251799813685248L, 8589934616L, 8L, 8589934626L, 65536L, 8589934622L, 1048576L, 8589934620L, 140737488355328L, 8589934614L,
                144115188075855872L, 8589934630L, 131072L, 8589934618L, 4L, 8589934622L, 134217728L, 8589934624L, 9007199254740992L, 8589934616L,
                1125899906842624L, 8589934624L, 268435456L, 8589934620L, 2251799813685248L, 8589934618L, 281474976710656L, 8589934626L, 32L, 8589934620L,
                2251799813685248L, 8589934620L, 281474976710656L, 8589934624L, 32768L, 8589934620L, 536870912L, 8589934610L, 1048576L, 8589934636L, 2097152L,
                8589934616L, 4096L, 8589934626L, 1099511627776L, 8589934612L, 36028797018963968L, 8589934628L, 281474976710656L, 8589934622L, 17179869184L,
                8589934622L, 1125899906842624L, 8589934616L, 268435456L, 8589934622L, 2147483648L, 8589934620L, 9007199254740992L, 8589934628L, 2097152L,
                8589934622L, 1L, 8589934622L, 128L, 8589934618L, 65536L, 8589934624L, 65536L, 8589934620L, 32768L, 8589934622L, 1024L, 8589934620L,
                140737488355328L, 8589934620L, 8388608L, 8589934622L, 8388608L, 8589934616L, 281474976710656L, 8589934624L, 1152921504606846976L,
                8589934622L, 4294967296L, 8589934626L, 128L, 8589934614L, 144115188075855872L, 8589934618L, 256L, 8589934628L, 8388608L, 8589934624L, 32768L,
                8589934618L, 4398046511104L, 8589934624L, 1L, 8589934622L, 67108864L, 8589934620L, 4294967296L, 8589934620L, 68719476736L, 8589934620L,
                70368744177664L, 8589934620L, 8L, 8589934620L, 4096L, 8589934626L, 68719476736L, 8589934612L, 8589934592L, 8589934662L, 8388608L,
                8589934618L, 262144L, 8589934612L, 1024L, 8589934634L, 17592186044416L, 8589934622L, 68719476736L, 8589934650L, 4611686018427387904L,
                8589934614L, 17592186044416L, 8589934630L, 70368744177664L, 8589934616L, 2251799813685248L, 8589934626L, 34359738368L, 8589934620L,
                2305843009213693952L, 8589934624L, 1048576L, 8589934622L, 8L, 8589934620L, 281474976710656L, 8589934620L, 9007199254740992L, 8589934620L,
                288230376151711744L, 8589934624L, 1099511627776L, 8589934612L, 281474976710656L, 8589934628L, 281474976710656L, 8589934624L, 134217728L,
                8589934620L, 1152921504606846976L, 8589934622L, 137438953472L, 8589934620L, 8388608L, 8589934622L, 8388608L, 8589934620L, 36028797018963968L,
                8589934622L, 4194304L, 8589934622L, 1L, 8589934622L, 8L, 8589934614L, 536870912L, 8589934628L, 131072L, 8589934622L, 65536L, 8589934620L,
                17592186044416L, 8589934614L, 2251799813685248L, 8589934624L, 8388608L, 8589934624L, 8796093022208L, 8589934622L, 68719476736L, 8589934622L,
                144115188075855872L, 8589934622L, 34359738368L, 8589934618L, 576460752303423488L, 8589934622L, 9007199254740992L, 8589934624L, 34359738368L,
                8589934620L, 2L, 8589934622L, 4294967296L, 8589934622L, 524288L, 8589934620L, 536870912L, 8589934616L, 33554432L, 8589934624L, 4L,
                8589934624L, 17179869184L, 8589934622L, 4398046511104L, 8589934618L, 68719476736L, 8589934620L, 33554432L, 8589934626L, 8589934592L,
                8589934608L, 4611686018427387904L, 8589934634L, 8589934592L, 8589934622L, 134217728L, 8589934618L, 562949953421312L, 8589934612L,
                2305843009213693952L, 8589934620L, 64L, 8589934630L, 35184372088832L, 8589934622L, 17592186044416L, 8589934622L, 8L, 8589934620L,
                2251799813685248L, 8589934622L, 32768L, 8589934624L, 4611686018427387904L, 8589934622L, 17179869184L, 8589934618L, 32768L, 8589934624L,
                4294967296L, 8589934614L, 1125899906842624L, 8589934624L, 32L, 8589934626L, 2L, 8589934620L, 16384L, 8589934622L, 1152921504606846976L,
                8589934620L, 4294967296L, 8589934610L, 8192L, 8589934634L, 72057594037927936L, 8589934620L, 2147483648L, 8589934620L, 2048L, 8589934624L,
                1125899906842624L, 8589934606L, 18014398509481984L, 8589934628L, 140737488355328L, 8589934630L, 512L, 8589934620L, 144115188075855872L,
                8589934622L, 131072L, 8589934622L, 274877906944L, 8589934612L, 8796093022208L, 8589934626L, 2199023255552L, 8589934624L, 64L, 8589934618L,
                35184372088832L, 8589934626L, 2097152L, 8589934618L, 1099511627776L, 8589934624L, 262144L, 8589934616L, 34359738368L, 8589934626L,
                4503599627370496L, 8589934622L, 137438953472L, 8589934610L, 144115188075855872L, 8589934632L, 4294967296L, 8589934620L, 16L, 8589934624L, 8L,
                8589934616L, 17179869184L, 8589934622L, 562949953421312L, 8589934624L, 144115188075855872L, 8589934622L, 65536L, 8589934622L, 8192L,
                8589934618L, 8589934592L, 8589934620L, 8796093022208L, 8589934622L, 524288L, 8589934624L, 32L, 8589934618L, 33554432L, 8589934618L,
                8589934592L, 8589934628L, 8192L, 8589934622L, 32768L, 8589934618L, 17592186044416L, 8589934622L, 2305843009213693952L, 8589934614L,
                1125899906842624L, 8589934620L, 67108864L, 8589934628L, 2305843009213693952L, 8589934624L, 32768L, 8589934620L, 576460752303423488L,
                8589934622L, 576460752303423488L, 8589934610L, 1152921504606846976L, 8589934634L, 2199023255552L, 8589934616L, 16777216L, 8589934626L,
                72057594037927936L, 8589934622L, 4096L, 8589934618L, 4L, 8589934622L, 524288L, 8589934624L, 256L, 8589934620L, 17592186044416L, 8589934620L,
                9007199254740992L, 8589934624L, 8192L, 8589934616L, 288230376151711744L, 8589934626L, 4L, 8589934622L, 4096L, 8589934616L, 9007199254740992L,
                8589934624L, 1099511627776L, 8589934614L, 512L, 8589934630L, 16L, 8589934622L, 131072L, 8589934620L, 72057594037927936L, 8589934622L,
                34359738368L, 8589934620L, 1L, 8589934618L, 268435456L, 8589934626L, 536870912L, 8589934622L, 16L, 8589934618L, 16384L, 8589934622L,
                288230376151711744L, 8589934622L, 4398046511104L, 8589934622L, 512L, 8589934620L, 4398046511104L, 8589934622L, 64L, 8589934622L, 2048L,
                8589934620L, 2048L, 8589934620L, 64L, 8589934622L, 137438953472L, 8589934620L, 562949953421312L, 8589934616L, 68719476736L, 8589934626L,
                33554432L, 8589934622L, 18014398509481984L, 8589934622L, 8589934592L, 8589934622L, 65536L, 8589934622L, 35184372088832L, 8589934614L,
                18014398509481984L, 8589934628L, 512L, 8589934618L, 72057594037927936L, 8589934624L, 140737488355328L, 8589934616L, 18014398509481984L,
                8589934626L, 4503599627370496L, 8589934622L, 2147483648L, 8589934618L, 1152921504606846976L, 8589934622L, 4294967296L, 8589934624L, 512L,
                8589934620L, 34359738368L, 8589934616L, 140737488355328L, 8589934628L, 131072L, 8589934620L, 17592186044416L, 8589934622L,
                72057594037927936L, 8589934622L, 512L, 8589934616L, 8192L, 8589934626L, 128L, 8589934618L, 4L, 8589934626L, 1024L, 8589934620L,
                2251799813685248L, 8589934620L, 64L, 8589934622L, 16L, 8589934620L, 2251799813685248L, 8589934624L, 512L, 8589934610L, 549755813888L,
                8589934618L, 2251799813685248L, 8589934634L, 16777216L, 8589934620L, 268435456L, 8589934622L, 524288L, 8589934622L, 549755813888L,
                8589934622L, 256L, 8589934622L, 256L, 8589934620L, 18014398509481984L, 8589934622L, 2147483648L, 8589934648L, 268435456L, 8589934626L, 4L,
                8589934620L, 16384L, 8589934616L, 549755813888L, 8589934626L, 9007199254740992L, 8589934622L, 8L, 8589934616L, 34359738368L, 8589934626L,
                4503599627370496L, 8589934616L, 8L, 8589934628L, 268435456L, 8589934616L, 549755813888L, 8589934620L, -9223372036854775808L, 8589934626L,
                2097152L, 8589934622L, 68719476736L, 8589934622L, 16777216L, 8589934610L, 281474976710656L, 8589934628L, 1073741824L, 8589934626L, 2L,
                8589934610L, 2048L, 8589934626L, 16L, 8589934628L, 8L, 8589934620L, 562949953421312L, 8589934618L, 137438953472L, 8589934624L,
                72057594037927936L, 8589934620L, 2048L, 8589934618L, 262144L, 8589934626L, 32768L, 8589934622L, 536870912L, 8589934614L, 288230376151711744L,
                8589934624L, 2097152L, 8589934618L, 32L, 8589934628L, 576460752303423488L, 8589934614L, 549755813888L, 8589934628L, 536870912L, 8589934620L,
                524288L, 8589934622L, 9007199254740992L, 8589934620L, 4398046511104L, 8589934618L, 33554432L, 8589934626L, 281474976710656L, 8589934622L,
                4294967296L, 8589934622L, 512L, 8589934620L, 288230376151711744L, 8589934622L, 2305843009213693952L, 8589934618L, 9007199254740992L,
                8589934620L, 2251799813685248L, 8589934620L, 288230376151711744L, 8589934628L, 1024L, 8589934620L, 9007199254740992L, 8589934620L, 1024L,
                8589934612L, 2251799813685248L, 8589934632L, 1073741824L, 8589934614L, 8796093022208L, 8589934630L, 65536L, 8589934614L, 16384L, 8589934624L,
                1073741824L, 8589934624L, 8796093022208L, 8589934618L, 4L, 8589934626L, 67108864L, 8589934622L, 4L, 8589934616L, 2305843009213693952L,
                8589934622L, 8589934592L, 8589934624L, 68719476736L, 8589934622L, 16L, 8589934616L, 8589934592L, 8589934620L, 281474976710656L, 8589934622L,
                131072L, 8589934628L, 2L, 8589934610L, 2251799813685248L, 8589934630L, 281474976710656L, 8589934622L, 4611686018427387904L, 8589934620L,
                16777216L, 8589934622L, -9223372036854775808L, 8589934622L, 524288L, 8589934616L, 1073741824L, 8589934626L, 33554432L, 8589934620L,
                536870912L, 8589934618L, 34359738368L, 8589934624L, 16384L, 8589934622L, 4194304L, 8589934620L, 1099511627776L, 8589934622L,
                2251799813685248L, 8589934622L, 536870912L, 8589934622L, 68719476736L, 8589934620L, 281474976710656L, 8589934622L, 4L, 8589934620L, 1L,
                8589934624L, 128L, 8589934618L, 67108864L, 8589934618L, 288230376151711744L, 8589934624L, 2L, 8589934624L, 4611686018427387904L, 8589934620L,
                4611686018427387904L, 8589934622L, 562949953421312L, 8589934620L, 137438953472L, 8589934624L, 64L, 8589934618L, 16777216L, 8589934624L,
                524288L, 8589934622L, 32L, 8589934616L, 33554432L, 8589934624L, 4194304L, 8589934622L, 8589934592L, 8589934620L, 16777216L, 8589934622L,
                16384L, 8589934622L, 8388608L, 8589934622L, 262144L, 8589934614L, 68719476736L, 8589934628L, 281474976710656L, 8589934618L, 1L, 8589934624L,
                4096L, 8589934618L, 2147483648L, 8589934624L, 36028797018963968L, 8589934622L, 8388608L, 8589934616L, 256L, 8589934626L, 2L, 8589934618L,
                1073741824L, 8589934626L, 64L, 8589934620L, 18014398509481984L, 8589934622L, 2305843009213693952L, 8589934620L, 8589934592L, 8589934612L,
                64L, 8589934630L, 281474976710656L, 8589934624L, 134217728L, 8589934618L, 16777216L, 8589934624L, 1073741824L, 8589934620L, 68719476736L,
                8589934622L, 68719476736L, 8589934620L, 1024L, 8589934620L, 256L, 8589934622L, 562949953421312L, 8589934624L, 262144L, 8589934620L,
                562949953421312L, 8589934620L, 288230376151711744L, 8589934624L, 64L, 8589934618L, 16384L, 8589934624L, 536870912L, 8589934622L, 512L,
                8589934620L, 16384L, 8589934618L, 16384L, 8589934624L, 32L, 8589934616L, 268435456L, 8589934622L, 140737488355328L, 8589934626L, 2L,
                8589934620L, 2199023255552L, 8589934622L, 65536L, 8589934622L, 512L, 8589934616L, 4398046511104L, 8589934626L, 68719476736L, 8589934622L,
                35184372088832L, 8589934618L, 1L, 8589934622L, 18014398509481984L, 8589934624L, 512L, 8589934620L, 1024L, 8589934618L, -9223372036854775808L,
                8589934622L, 131072L, 8589934622L, 288230376151711744L, 8589934624L, 274877906944L, 8589934620L, 2305843009213693952L, 8589934620L,
                67108864L, 8589934620L, 131072L, 8589934614L, 134217728L, 8589934632L, 1024L, 8589934620L, 18014398509481984L, 8589934616L, 2L, 8589934622L,
                1125899906842624L, 8589934626L, 4L, 8589934616L, 262144L, 8589934626L, 562949953421312L, 8589934618L, 274877906944L, 8589934622L, 64L,
                8589934624L, 8796093022208L, 8589934622L, 8192L, 8589934614L, 140737488355328L, 8589934628L, 35184372088832L, 8589934618L, 9007199254740992L,
                8589934624L, 288230376151711744L, 8589934620L, 4611686018427387904L, 8589934624L, 16384L, 8589934620L, 1125899906842624L, 8589934614L,
                1125899906842624L, 8589934630L, 131072L, 8589934618L, 1L, 8589934624L, 1125899906842624L, 8589934622L, 2097152L, 8589934618L, 262144L,
                8589934622L, 1125899906842624L, 8589934620L, 4398046511104L, 8589934622L, 1099511627776L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0
        };

        long[] goodData = new long[]{
                8589934620L, 2097152L, 8589934620L, 2097152L, 8589934624L, 1024L, 8589934612L, 549755813888L, 8589934630L, 268435456L, 8589934622L,
                8589934592L, 8589934622L, 2L, 8589934618L, 1L, 8589934622L, 33554432L, 8589934620L, 65536L, 8589934620L, 35184372088832L, 8589934620L,
                2305843009213693952L, 8589934628L, 16L, 8589934644L, 36028797018963968L, 8589934628L, 131072L, 8589934622L, 1024L, 8589934620L,
                1099511627776L, 8589934620L, 4611686018427387904L, 8589934620L, 137438953472L, 8589934618L, 281474976710656L, 8589934628L, 8589934592L,
                8589934620L, 70368744177664L, 8589934610L, 281474976710656L, 8589934634L, 256L, 8589934622L, 4096L, 8589934618L, 4294967296L, 8589934620L,
                17592186044416L, 8589934622L, 33554432L, 8589934618L, 68719476736L, 8589934622L, 4611686018427387904L, 8589934626L, 1048576L, 8589934618L,
                576460752303423488L, 8589934614L, 288230376151711744L, 8589934632L, 70368744177664L, 8589934618L, 131072L, 8589934624L, 70368744177664L,
                8589934614L, 4503599627370496L, 8589934628L, 36028797018963968L, 8589934622L, -9223372036854775808L, 8589934618L, 72057594037927936L,
                8589934622L, 562949953421312L, 8589934620L, 17179869184L, 8589934624L, 128L, 8589934620L, 2199023255552L, 8589934624L, 8796093022208L,
                8589934620L, 281474976710656L, 8589934622L, 1L, 8589934616L, 549755813888L, 8589934626L, 2L, 8589934620L, 2199023255552L, 8589934624L,
                1073741824L, 8589934620L, 4611686018427387904L, 8589934618L, 2097152L, 8589934624L, 262144L, 8589934616L, 65536L, 8589934626L, 131072L,
                8589934622L, 576460752303423488L, 8589934622L, 4L, 8589934622L, 256L, 8589934614L, 32768L, 8589934626L, 67108864L, 8589934622L, 1024L,
                8589934620L, 2199023255552L, 8589934618L, 9007199254740992L, 8589934620L, 4096L, 8589934626L, 524288L, 8589934614L, 2097152L, 8589934626L,
                33554432L, 8589934626L, 262144L, 8589934620L, 288230376151711744L, 8589934622L, 70368744177664L, 8589934622L, 8192L, 8589934620L,
                17592186044416L, 8589934622L, 65536L, 8589934618L, 8388608L, 8589934624L, 1048576L, 8589934620L, 4294967296L, 8589934622L, 134217728L,
                8589934616L, 140737488355328L, 8589934628L, 549755813888L, 8589934616L, 70368744177664L, 8589934626L, 274877906944L, 8589934622L, 33554432L,
                8589934620L, 1048576L, 8589934616L, 64L, 8589934616L, 4503599627370496L, 8589934632L, 131072L, 8589934616L, 16L, 8589934618L,
                -9223372036854775808L, 8589934630L, 70368744177664L, 8589934620L, 4096L, 8589934618L, 128L, 8589934622L, 576460752303423488L, 8589934620L,
                9007199254740992L, 8589934626L, 4611686018427387904L, 8589934622L, 64L, 8589934620L, 4503599627370496L, 8589934622L, 8192L, 8589934622L,
                16384L, 8589934614L, 1125899906842624L, 8589934628L, 17592186044416L, 8589934618L, 524288L, 8589934624L, 137438953472L, 8589934610L,
                1099511627776L, 8589934628L, 17592186044416L, 8589934622L, 1099511627776L, 8589934616L, 2048L, 8589934628L, 35184372088832L, 8589934624L, 4L,
                8589934622L, 8388608L, 8589934620L, 70368744177664L, 8589934610L, 4294967296L, 8589934628L, 32L, 8589934622L, 2097152L, 8589934622L, 1L,
                8589934618L, 144115188075855872L, 8589934626L, 2048L, 8589934616L, 140737488355328L, 8589934628L, 9007199254740992L, 8589934620L,
                2305843009213693952L, 8589934622L, 16L, 8589934614L, 1073741824L, 8589934622L, 64L, 8589934626L, 134217728L, 8589934622L, 4294967296L,
                8589934604L, 16384L, 8589934640L, 4L, 8589934620L, 562949953421312L, 8589934620L, 8192L, 8589934624L, 281474976710656L, 8589934618L,
                70368744177664L, 8589934622L, 562949953421312L, 8589934624L, 16L, 8589934620L, 17592186044416L, 8589934622L, 576460752303423488L,
                8589934616L, 9007199254740992L, 8589934618L, 70368744177664L, 8589934628L, 140737488355328L, 8589934616L, 274877906944L, 8589934624L, 1024L,
                8589934618L, 2305843009213693952L, 8589934628L, 4398046511104L, 8589934622L, 4611686018427387904L, 8589934618L, 16384L, 8589934624L,
                9007199254740992L, 8589934622L, 274877906944L, 8589934620L, 137438953472L, 8589934620L, 18014398509481984L, 8589934624L, 262144L,
                8589934618L, 4294967296L, 8589934624L, 1073741824L, 8589934622L, 2L, 8589934616L, 262144L, 8589934626L, 34359738368L, 8589934620L,
                144115188075855872L, 8589934616L, 16384L, 8589934624L, 4194304L, 8589934626L, 512L, 8589934620L, 288230376151711744L, 8589934622L,
                268435456L, 8589934620L, 32L, 8589934622L, 4L, 8589934622L, 128L, 8589934620L, 8192L, 8589934618L, 8388608L, 8589934624L, 67108864L,
                8589934606L, 35184372088832L, 8589934636L, 72057594037927936L, 8589934622L, 4611686018427387904L, 8589934622L, 16384L, 8589934614L,
                274877906944L, 8589934628L, 262144L, 8589934622L, 35184372088832L, 8589934620L, 4L, 8589934622L, 32768L, 8589934622L, 68719476736L,
                8589934620L, 2251799813685248L, 8589934616L, 8L, 8589934626L, 65536L, 8589934622L, 1048576L, 8589934620L, 140737488355328L, 8589934614L,
                144115188075855872L, 8589934630L, 131072L, 8589934618L, 4L, 8589934622L, 134217728L, 8589934624L, 9007199254740992L, 8589934616L,
                1125899906842624L, 8589934624L, 268435456L, 8589934620L, 2251799813685248L, 8589934618L, 281474976710656L, 8589934626L, 32L, 8589934620L,
                2251799813685248L, 8589934620L, 281474976710656L, 8589934624L, 32768L, 8589934620L, 536870912L, 8589934610L, 1048576L, 8589934636L, 2097152L,
                8589934616L, 4096L, 8589934626L, 1099511627776L, 8589934612L, 36028797018963968L, 8589934628L, 281474976710656L, 8589934622L, 17179869184L,
                8589934622L, 1125899906842624L, 8589934616L, 268435456L, 8589934622L, 2147483648L, 8589934620L, 9007199254740992L, 8589934628L, 2097152L,
                8589934622L, 1L, 8589934622L, 128L, 8589934618L, 65536L, 8589934624L, 65536L, 8589934620L, 32768L, 8589934622L, 1024L, 8589934620L,
                140737488355328L, 8589934620L, 8388608L, 8589934622L, 8388608L, 8589934616L, 281474976710656L, 8589934624L, 1152921504606846976L,
                8589934622L, 4294967296L, 8589934626L, 128L, 8589934614L, 144115188075855872L, 8589934618L, 256L, 8589934628L, 8388608L, 8589934624L, 32768L,
                8589934618L, 4398046511104L, 8589934624L, 1L, 8589934622L, 67108864L, 8589934620L, 4294967296L, 8589934620L, 68719476736L, 8589934620L,
                70368744177664L, 8589934620L, 8L, 8589934620L, 4096L, 8589934626L, 68719476736L, 8589934612L, 8589934592L, 8589934662L, 8388608L,
                8589934618L, 262144L, 8589934612L, 1024L, 8589934634L, 17592186044416L, 8589934622L, 68719476736L, 8589934650L, 4611686018427387904L,
                8589934614L, 17592186044416L, 8589934630L, 70368744177664L, 8589934616L, 2251799813685248L, 8589934626L, 34359738368L, 8589934620L,
                2305843009213693952L, 8589934624L, 1048576L, 8589934622L, 8L, 8589934620L, 281474976710656L, 8589934620L, 9007199254740992L, 8589934620L,
                288230376151711744L, 8589934624L, 1099511627776L, 8589934612L, 281474976710656L, 8589934628L, 281474976710656L, 8589934624L, 134217728L,
                8589934620L, 1152921504606846976L, 8589934622L, 137438953472L, 8589934620L, 8388608L, 8589934622L, 8388608L, 8589934620L, 36028797018963968L,
                8589934622L, 4194304L, 8589934622L, 1L, 8589934622L, 8L, 8589934614L, 536870912L, 8589934628L, 131072L, 8589934622L, 65536L, 8589934620L,
                17592186044416L, 8589934614L, 2251799813685248L, 8589934624L, 8388608L, 8589934624L, 8796093022208L, 8589934622L, 68719476736L, 8589934622L,
                144115188075855872L, 8589934622L, 34359738368L, 8589934618L, 576460752303423488L, 8589934622L, 9007199254740992L, 8589934624L, 34359738368L,
                8589934620L, 2L, 8589934622L, 4294967296L, 8589934622L, 524288L, 8589934620L, 536870912L, 8589934616L, 33554432L, 8589934624L, 4L,
                8589934624L, 17179869184L, 8589934622L, 4398046511104L, 8589934618L, 68719476736L, 8589934620L, 33554432L, 8589934626L, 8589934592L,
                8589934608L, 4611686018427387904L, 8589934634L, 8589934592L, 8589934622L, 134217728L, 8589934618L, 562949953421312L, 8589934612L,
                2305843009213693952L, 8589934620L, 64L, 8589934630L, 35184372088832L, 8589934622L, 17592186044416L, 8589934622L, 8L, 8589934620L,
                2251799813685248L, 8589934622L, 32768L, 8589934624L, 4611686018427387904L, 8589934622L, 17179869184L, 8589934618L, 32768L, 8589934624L,
                4294967296L, 8589934614L, 1125899906842624L, 8589934624L, 32L, 8589934626L, 2L, 8589934620L, 16384L, 8589934622L, 1152921504606846976L,
                8589934620L, 4294967296L, 8589934610L, 8192L, 8589934634L, 72057594037927936L, 8589934620L, 2147483648L, 8589934620L, 2048L, 8589934624L,
                1125899906842624L, 8589934606L, 18014398509481984L, 8589934628L, 140737488355328L, 8589934630L, 512L, 8589934620L, 144115188075855872L,
                8589934622L, 131072L, 8589934622L, 274877906944L, 8589934612L, 8796093022208L, 8589934626L, 2199023255552L, 8589934624L, 64L, 8589934618L,
                35184372088832L, 8589934626L, 2097152L, 8589934618L, 1099511627776L, 8589934624L, 262144L, 8589934616L, 34359738368L, 8589934626L,
                4503599627370496L, 8589934622L, 137438953472L, 8589934610L, 144115188075855872L, 8589934632L, 4294967296L, 8589934620L, 16L, 8589934624L, 8L,
                8589934616L, 17179869184L, 8589934622L, 562949953421312L, 8589934624L, 144115188075855872L, 8589934622L, 65536L, 8589934622L, 8192L,
                8589934618L, 8589934592L, 8589934620L, 8796093022208L, 8589934622L, 524288L, 8589934624L, 32L, 8589934618L, 33554432L, 8589934618L,
                8589934592L, 8589934628L, 8192L, 8589934622L, 32768L, 8589934618L, 17592186044416L, 8589934622L, 2305843009213693952L, 8589934614L,
                1125899906842624L, 8589934620L, 67108864L, 8589934628L, 2305843009213693952L, 8589934624L, 32768L, 8589934620L, 576460752303423488L,
                8589934622L, 576460752303423488L, 8589934610L, 1152921504606846976L, 8589934634L, 2199023255552L, 8589934616L, 16777216L, 8589934626L,
                72057594037927936L, 8589934622L, 4096L, 8589934618L, 4L, 8589934622L, 524288L, 8589934624L, 256L, 8589934620L, 17592186044416L, 8589934620L,
                9007199254740992L, 8589934624L, 8192L, 8589934616L, 288230376151711744L, 8589934626L, 4L, 8589934622L, 4096L, 8589934616L, 9007199254740992L,
                8589934624L, 1099511627776L, 8589934614L, 512L, 8589934630L, 16L, 8589934622L, 131072L, 8589934620L, 72057594037927936L, 8589934622L,
                34359738368L, 8589934620L, 1L, 8589934618L, 268435456L, 8589934626L, 536870912L, 8589934622L, 16L, 8589934618L, 16384L, 8589934622L,
                288230376151711744L, 8589934622L, 4398046511104L, 8589934622L, 512L, 8589934620L, 4398046511104L, 8589934622L, 64L, 8589934622L, 2048L,
                8589934620L, 2048L, 8589934620L, 64L, 8589934622L, 137438953472L, 8589934620L, 562949953421312L, 8589934616L, 68719476736L, 8589934626L,
                33554432L, 8589934622L, 18014398509481984L, 8589934622L, 8589934592L, 8589934622L, 65536L, 8589934622L, 35184372088832L, 8589934614L,
                18014398509481984L, 8589934628L, 512L, 8589934618L, 72057594037927936L, 8589934624L, 140737488355328L, 8589934616L, 18014398509481984L,
                8589934626L, 4503599627370496L, 8589934622L, 2147483648L, 8589934618L, 1152921504606846976L, 8589934622L, 4294967296L, 8589934624L, 512L,
                8589934620L, 34359738368L, 8589934616L, 140737488355328L, 8589934628L, 131072L, 8589934620L, 17592186044416L, 8589934622L,
                72057594037927936L, 8589934622L, 512L, 8589934616L, 8192L, 8589934626L, 128L, 8589934618L, 4L, 8589934626L, 1024L, 8589934620L,
                2251799813685248L, 8589934620L, 64L, 8589934622L, 16L, 8589934620L, 2251799813685248L, 8589934624L, 512L, 8589934610L, 549755813888L,
                8589934618L, 2251799813685248L, 8589934634L, 16777216L, 8589934620L, 268435456L, 8589934622L, 524288L, 8589934622L, 549755813888L,
                8589934622L, 256L, 8589934622L, 256L, 8589934620L, 18014398509481984L, 8589934622L, 2147483648L, 8589934648L, 268435456L, 8589934626L, 4L,
                8589934620L, 16384L, 8589934616L, 549755813888L, 8589934626L, 9007199254740992L, 8589934622L, 8L, 8589934616L, 34359738368L, 8589934626L,
                4503599627370496L, 8589934616L, 8L, 8589934628L, 268435456L, 8589934616L, 549755813888L, 8589934620L, -9223372036854775808L, 8589934626L,
                2097152L, 8589934622L, 68719476736L, 8589934622L, 16777216L, 8589934610L, 281474976710656L, 8589934628L, 1073741824L, 8589934626L, 2L,
                8589934610L, 2048L, 8589934626L, 16L, 8589934628L, 8L, 8589934620L, 562949953421312L, 8589934618L, 137438953472L, 8589934624L,
                72057594037927936L, 8589934620L, 2048L, 8589934618L, 262144L, 8589934626L, 32768L, 8589934622L, 536870912L, 8589934614L, 288230376151711744L,
                8589934624L, 2097152L, 8589934618L, 32L, 8589934628L, 576460752303423488L, 8589934614L, 549755813888L, 8589934628L, 536870912L, 8589934620L,
                524288L, 8589934622L, 9007199254740992L, 8589934620L, 4398046511104L, 8589934618L, 33554432L, 8589934626L, 281474976710656L, 8589934622L,
                4294967296L, 8589934622L, 512L, 8589934620L, 288230376151711744L, 8589934622L, 2305843009213693952L, 8589934618L, 9007199254740992L,
                8589934620L, 2251799813685248L, 8589934620L, 288230376151711744L, 8589934628L, 1024L, 8589934620L, 9007199254740992L, 8589934620L, 1024L,
                8589934612L, 2251799813685248L, 8589934632L, 1073741824L, 8589934614L, 8796093022208L, 8589934630L, 65536L, 8589934614L, 16384L, 8589934624L,
                1073741824L, 8589934624L, 8796093022208L, 8589934618L, 4L, 8589934626L, 67108864L, 8589934622L, 4L, 8589934616L, 2305843009213693952L,
                8589934622L, 8589934592L, 8589934624L, 68719476736L, 8589934622L, 16L, 8589934616L, 8589934592L, 8589934620L, 281474976710656L, 8589934622L,
                131072L, 8589934628L, 2L, 8589934610L, 2251799813685248L, 8589934630L, 281474976710656L, 8589934622L, 4611686018427387904L, 8589934620L,
                16777216L, 8589934622L, -9223372036854775808L, 8589934622L, 524288L, 8589934616L, 1073741824L, 8589934626L, 33554432L, 8589934620L,
                536870912L, 8589934618L, 34359738368L, 8589934624L, 16384L, 8589934622L, 4194304L, 8589934620L, 1099511627776L, 8589934622L,
                2251799813685248L, 8589934622L, 536870912L, 8589934622L, 68719476736L, 8589934620L, 281474976710656L, 8589934622L, 4L, 8589934620L, 1L,
                8589934624L, 128L, 8589934618L, 67108864L, 8589934618L, 288230376151711744L, 8589934624L, 2L, 8589934624L, 4611686018427387904L, 8589934620L,
                4611686018427387904L, 8589934622L, 562949953421312L, 8589934620L, 137438953472L, 8589934624L, 64L, 8589934618L, 16777216L, 8589934624L,
                524288L, 8589934622L, 32L, 8589934616L, 33554432L, 8589934624L, 4194304L, 8589934622L, 8589934592L, 8589934620L, 16777216L, 8589934622L,
                16384L, 8589934622L, 8388608L, 8589934622L, 262144L, 8589934614L, 68719476736L, 8589934628L, 281474976710656L, 8589934618L, 1L, 8589934624L,
                4096L, 8589934618L, 2147483648L, 8589934624L, 36028797018963968L, 8589934622L, 8388608L, 8589934616L, 256L, 8589934626L, 2L, 8589934618L,
                1073741824L, 8589934626L, 64L, 8589934620L, 18014398509481984L, 8589934622L, 2305843009213693952L, 8589934620L, 8589934592L, 8589934612L,
                64L, 8589934630L, 281474976710656L, 8589934624L, 134217728L, 8589934618L, 16777216L, 8589934624L, 1073741824L, 8589934620L, 68719476736L,
                8589934622L, 68719476736L, 8589934620L, 1024L, 8589934620L, 256L, 8589934622L, 562949953421312L, 8589934624L, 262144L, 8589934620L,
                562949953421312L, 8589934620L, 288230376151711744L, 8589934624L, 64L, 8589934618L, 16384L, 8589934624L, 536870912L, 8589934622L, 512L,
                8589934620L, 16384L, 8589934618L, 16384L, 8589934624L, 32L, 8589934616L, 268435456L, 8589934622L, 140737488355328L, 8589934626L, 2L,
                8589934620L, 2199023255552L, 8589934622L, 65536L, 8589934622L, 512L, 8589934616L, 4398046511104L, 8589934626L, 68719476736L, 8589934622L,
                35184372088832L, 8589934618L, 1L, 8589934622L, 18014398509481984L, 8589934624L, 512L, 8589934620L, 1024L, 8589934618L, -9223372036854775808L,
                8589934622L, 131072L, 8589934622L, 288230376151711744L, 8589934624L, 274877906944L, 8589934620L, 2305843009213693952L, 8589934620L,
                67108864L, 8589934620L, 131072L, 8589934614L, 134217728L, 8589934632L, 1024L, 8589934620L, 18014398509481984L, 8589934616L, 2L, 8589934622L,
                1125899906842624L, 8589934626L, 4L, 8589934616L, 262144L, 8589934626L, 562949953421312L, 8589934618L, 274877906944L, 8589934622L, 64L,
                8589934624L, 8796093022208L, 8589934622L, 8192L, 8589934614L, 140737488355328L, 8589934628L, 35184372088832L, 8589934618L, 9007199254740992L,
                8589934624L, 288230376151711744L, 8589934620L, 4611686018427387904L, 8589934624L, 16384L, 8589934620L, 1125899906842624L, 8589934614L,
                1125899906842624L, 8589934630L, 131072L, 8589934618L, 1L, 8589934624L, 1125899906842624L, 8589934622L, 2097152L, 8589934618L, 262144L,
                8589934622L, 1125899906842624L, 8589934620L, 4398046511104L, 8589934622L, 1099511627776L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
                0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0
        };

        assertEquals(badData.length, goodData.length);
        for (int i = 0; i < badData.length; i++) {
            assertEquals(badData[i], goodData[i]);
        }
    }

    @Test
    public void testScaryIntegers() {
        int[] ids = new int[]{917, 1877, 2954, 3687, 4956, 5985, 6977, 7872, 8921, 9872, 10861, 11837, 12996, 14775, 15953, 16970, 17960, 18942, 19877,
                20784, 21985, 22958, 23600, 24968, 25996, 26912, 27884, 28889, 29796, 30846, 31956, 32891, 33658, 34990, 35857, 36974, 37748, 38967, 39999,
                40888, 41905, 42850, 43911, 44905, 45995, 46960, 47936, 48807, 49921, 50921, 51998, 52990, 53845, 54930, 55760, 56913, 57979, 58946, 59976,
                60751, 61914, 62922, 63913, 64821, 65740, 66899, 67669, 68825, 69970, 70970, 71982, 72973, 73964, 74960, 75863, 76948, 77920, 78939, 79791,
                80999, 81838, 82982, 83993, 84948, 85766, 86644, 87953, 88772, 89727, 90990, 91916, 92807, 93883, 94837, 95998, 96966, 97972, 98957, 99982,
                100786, 101996, 102867, 103973, 104616, 105836, 106856, 107659, 108909, 109954, 110999, 111982, 112608, 113797, 114837, 115840, 116793,
                117899, 118767, 119989, 120957, 121924, 122718, 123718, 124891, 125920, 126350, 127938, 128945, 129869, 130992, 131886, 132913, 133956,
                134956, 135995, 136821, 137710, 138927, 139750, 140810, 141757, 142954, 143998, 144846, 145973, 146982, 147941, 148918, 149970, 150880,
                151966, 152961, 153810, 154979, 155961, 156750, 157846, 158985, 159994, 160988, 161925, 162946, 163975, 164941, 165847, 166938, 167469,
                168952, 169982, 170958, 171750, 172946, 173997, 174914, 175951, 176996, 177971, 178755, 179920, 180948, 181935, 182713, 183953, 184834,
                185883, 186997, 187826, 188892, 189875, 190768, 191877, 192883, 193840, 194895, 195869, 196500, 197973, 198796, 199976, 200695, 201904,
                202914, 203954, 204764, 205791, 206773, 207957, 208960, 209991, 210896, 211984, 212943, 213962, 214959, 215895, 216919, 217776, 218876,
                219872, 220999, 221817, 222664, 223895, 224975, 225898, 226944, 227994, 228960, 229924, 230894, 231811, 232780, 233956, 234657, 236951,
                237842, 238538, 239980, 240996, 242942, 243692, 244974, 245811, 246947, 247933, 248980, 249987, 250992, 251957, 252922, 253992, 254704,
                255920, 256987, 257980, 258981, 259927, 260951, 261943, 262934, 263936, 264963, 265757, 266961, 267984, 268972, 269747, 270807, 271915,
                272932, 273977, 274979, 275899, 276917, 277987, 278913, 279968, 280979, 281949, 282777, 283842, 284962, 285994, 286884, 287833, 288993,
                289598, 290977, 291995, 292913, 293629, 294534, 295853, 296876, 297859, 298867, 299855, 300990, 301986, 302863, 303968, 304754, 305797,
                306945, 307918, 308988, 309920, 310541, 311992, 312927, 313867, 314994, 315510, 316719, 317961, 318969, 319953, 320998, 321707, 322857,
                323910, 324845, 325973, 326888, 327954, 328803, 329972, 330981, 331641, 332960, 333892, 334979, 335842, 336881, 337977, 338960, 339981,
                340897, 341867, 342867, 343941, 344857, 345761, 346957, 347983, 348908, 349949, 350706, 351642, 352893, 353935, 354939, 355963, 356604,
                357993, 358808, 359992, 360972, 361858, 362899, 363976, 364972, 365941, 366989, 367866, 368962, 369996, 370869, 371944, 372681, 373956,
                374993, 375992, 376995, 377920, 378844, 379997, 380996, 381902, 382970, 383978, 384969, 385962, 386950, 387979, 388939, 389894, 390949,
                391921, 392740, 393881, 394934, 395937, 396944, 397997, 398774, 399945, 400888, 401967, 402806, 403956, 404959, 405884, 406880, 407945,
                408931, 409775, 410961, 411948, 412984, 413961, 414797, 415943, 416834, 417994, 418995, 419910, 420932, 421939, 422985, 423655, 424563,
                425944, 426908, 427923, 428967, 429960, 430984, 431990, 432991, 434844, 435970, 436942, 437799, 438965, 439939, 440803, 441972, 442755,
                443996, 444839, 445823, 446933, 447972, 448984, 449648, 450846, 451969, 452619, 453764, 454979, 455985, 456869, 457976, 458891, 459794,
                460943, 461981, 462778, 463829, 464709, 465979, 466727, 467933, 468883, 469941, 470890, 471769, 472944, 473952, 474953, 475962, 476989,
                477877, 478835, 479802, 480970, 481973, 482890, 483635, 484958, 485739, 486992, 487758, 488862, 489963, 490818, 491994, 492994, 493885,
                494881, 495972, 496964, 497825, 498800, 499793, 500993, 501683, 502960, 503998, 504920, 505983, 506963, 507806, 508953, 509917, 510819,
                511886, 512918, 513896, 514931, 515933, 516964, 517936, 518914, 519872, 520967, 521882, 522810, 523841, 524990, 525950, 526961, 527909,
                528966, 529880, 530963, 531973, 532825, 533910, 534945, 535896, 536910, 537943, 538962, 539748, 540976, 541824, 542924, 543839, 544951,
                545943, 546760, 547905, 548830, 549958, 550966, 551997, 552929, 553606, 554928, 555995, 556888, 557982, 558948, 559972, 560906, 561864,
                562929, 563986, 564977, 565946, 566982, 567886, 568989, 569993, 570958, 571854, 572933, 573788, 574831, 575937, 576937, 577936, 578953,
                579818, 580964, 581997, 582848, 583926, 584969, 585930, 586879, 587857, 588922, 589990, 590973, 591898, 592849, 593627, 594954, 595958,
                596737, 597810, 598914, 599762, 600945, 601830, 602822, 603947, 604941, 605743, 606957, 607861, 608954, 609918, 610958, 611954, 612722,
                613969, 614848, 615986, 616981, 617874, 618930, 619882, 620904};

        EWAHCompressedBitmap bmp = new EWAHCompressedBitmap();
        for (int i = 0; i < ids.length; i++) {
            int id = ids[i];
            assertTrue(id > 0 || ids[i-1] != ids[i] - 1);

            int[] nots = new int[i+1];
            for (int j = 0; j <= i; j++) {
                nots[j] = id-1;
            }
            EWAHCompressedBitmap toAndNot = new EWAHCompressedBitmap();
            EWAHCompressedBitmap.bitmapOf(nots);

            EWAHCompressedBitmap r = new EWAHCompressedBitmap();
            MatchNoMoreThanNBitmapStorage storage = new MatchNoMoreThanNBitmapStorage(r, bmp.sizeInBits());
            bmp.andNotToContainer(toAndNot, storage);
            bmp = r;
            bmp.set(id);
        }

        EWAHCompressedBitmap or = bmp.or(new EWAHCompressedBitmap());
        assertTrue(Arrays.equals(or.toArray(), bmp.toArray()));
    }
}
